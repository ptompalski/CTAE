% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/agb_lambert_ung.R
\name{agb_lambert_ung}
\alias{agb_lambert_ung}
\title{Calculate tree-level AGB using Lambert & Ung national biomass equations}
\usage{
agb_lambert_ung(
  DBH,
  height = NA_real_,
  species = NA,
  equation_set = c("auto", "dbh", "dbh_height"),
  keep_model_id = FALSE
)
}
\arguments{
\item{DBH}{Tree DBH (cm). Numeric vector.}

\item{height}{Tree height (m). Numeric vector. Optional for the dbh-only equation set.}

\item{species}{Tree species code in the NFI standard (e.g. `"POPU.TRE"`). Can be a
scalar (recycled) or a vector matching `DBH`.}

\item{equation_set}{Which Lambert & Ung equation set to use. One of `"auto"`, `"dbh"`,
`"dbh_height"`. `"auto"` makes a per-tree choice based on whether `height` is valid.}

\item{keep_model_id}{Logical. If `TRUE`, include a `model_id` column indicating which
equation set was used (`"DBH"` or `"DBHHT"`).}
}
\value{
A tibble with AGB components: `Bwood`, `Bbark`, `Bstem`, `Bfoliage`,
  `Bbranches`, `Bcrown`, `Btotal`. If `keep_model_id = TRUE`, includes `model_id`.
}
\description{
Unified interface for the Lambert et al. (2005) and Ung et al. (2008) Canadian
national tree aboveground biomass equations. Two equation sets are available:
dbh-only and dbh+height. By default (`equation_set = "auto"`), the dbh+height
set is used when valid `height` is provided, otherwise the dbh-only set is used.
}
\examples{

# Auto-selection (equation_set = "auto" by default):
# height missing -> DBH-only equations
agb_lambert_ung(
  DBH = 20,
  species = "PICE.MAR"
)

# height provided -> DBH + height equations
agb_lambert_ung(
  DBH = 20,
  height = 17,
  species = "PICE.MAR"
)

# Show which equation set was used (model_id appended as the last column)
agb_lambert_ung(
  DBH = 20,
  species = "PICE.MAR",
  keep_model_id = TRUE
)

# Force a specific equation set
agb_lambert_ung(
  DBH = 20,
  height = 17,
  species = "PICE.MAR",
  equation_set = "dbh"
)

# Multiple rows
trees <- tibble::tibble(
 tree_id = 1:4,
 DBH = c(22, 30, 18, 35),
 height = c(18, 24, NA, 27),
 species = c("PICE.GLA", "PICE.GLA", "ABIE.BAL", "PINU.BAN")
)

trees |>
 dplyr::mutate(
   agb = agb_lambert_ung(
     DBH = DBH,
     height = height,
     species = species,
     keep_model_id = TRUE
   )
 ) |>
 unnest(agb)
}
