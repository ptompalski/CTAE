% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/boudewyn.R
\name{agb_component_proportions}
\alias{agb_component_proportions}
\title{Boudewyn biomass component proportions (Tables 6–7)}
\usage{
agb_component_proportions(
  x,
  value_type = c("vol", "agb"),
  species,
  jurisdiction,
  ecozone,
  renormalize = TRUE,
  clamp_x = FALSE
)
}
\arguments{
\item{x}{Numeric vector. Input to the proportion models:
merchantable volume (t/ha) when value_type = "vol", or total biomass (t/ha)
when value_type = "agb".}

\item{value_type}{One of "vol" or "agb".}

\item{species}{Character vector. NFI species codes (e.g., "PICE.MAR").}

\item{jurisdiction}{Character vector. Jurisdiction code (e.g., "AB").}

\item{ecozone}{Ecozone identifier. Either: numeric ecozone code (1–15) or official ecozone name (English or French; case-insensitive).}

\item{renormalize}{Logical. Renormalize after capping to sum to 1.}

\item{clamp_x}{Logical. Clamp x to [x_min, x_max] from Table 7 before evaluating.}
}
\value{
Tibble with p_sw, p_sb, p_br, p_fl and optional x_used.
\describe{
  \item{p_sw}{Proportion of total biomass in stem wood.}
  \item{p_sb}{Proportion of total biomass in bark.}
  \item{p_br}{Proportion of total biomass in branches.}
  \item{p_fl}{Proportion of total biomass in foliage.}
}
}
\description{
Compute component proportions (stemwood, bark, branches, foliage) using the
multinomial-logit models (Table 6) and bounds (Table 7), either as a function
of merchantable volume ("vol") or total aboveground biomass ("agb").
}
\examples{
# ---- Volume-based proportions (most common use) ---------------------------

# Single stand
agb_component_proportions(
  x = 350,
  value_type = "vol",
  species = "PICE.MAR",
  jurisdiction = "AB",
  ecozone = 6
)


# ---- Biomass-based proportions --------------------------------------------

agb_component_proportions(
  x = 120,
  value_type = "agb",
  species = "PICE.MAR",
  jurisdiction = "AB",
  ecozone = 6
)


# ---- Vectorized / tidyverse workflow --------------------------------------

library(dplyr)
library(tidyr)

stands <- tibble::tibble(
  stand_id = 1:3,
  vol_merchantable = c(120, 350, 300),
  species = c("PICE.MAR", "PSEU.MEN", "PINU.BAN"),
  jurisdiction = c("AB", "BC", "ON"),
  ecozone = c(5, 13, 6)
)

stands |>
  mutate(
    props = agb_component_proportions(
      x = vol_merchantable,
      value_type = "vol",
      species = species,
      jurisdiction = jurisdiction,
      ecozone = ecozone
    )
  ) |>
  unnest(props)
}
